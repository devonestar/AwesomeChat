<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>LIST</title>
    <link rel='stylesheet' href='/webjars/bootstrap/4.5.0/css/bootstrap.min.css'>
  <script>
    function fn_projectCreate() {
      $.ajax({
        url:"/api/v1/users/",
        type:"GET",
        cache: false,
        data:{},
        dataType : "json",
        success:function(data){
          var userList = '<label for="projectUsers">프로젝트 참여인력</label></br>';
          for(var i=0;i<data.length;i++) {
            var userNm = data[i].userName;
            var userYear = data[i].userYear;

            userList += '<input type="checkbox" id="projectUsers" value="' + data[i].id + '"/>' + userNm;
          }
          $("#userCheckList").html("");
          $("#userCheckList").append(userList);
        },
        error:function(key, textStatus){
        }
      });
    }

    function fn_projectList() {
      $.ajax({
        url:"/api/v1/projects/",
        type:"GET",
        cache: false,
        data:{},
        dataType : "json",
        success:function(data){
          var projectList = '<table class="table"><thead class="thead-light"><tr class="text-center"><th scope="col">ID</th><th scope="col">PROJECTNAME</th><th scope="col">SUMMARY</th></tr></thead><tbody>';
          projectList += '</tr></thead><tbody>';
          for(var i=0;i<data.length;i++) {
            projectList += '<tr class="text-center">';
            var projectId = data[i].id;
            var projectName = data[i].projectName;
            var projectSummary = data[i].summary;

            projectList += '<th scope="row"><span th:text="' + projectId+ '">' + projectId + '</span></th>';
            projectList += '<td><a th:href=""><span th:text="' + projectName+ '">' + projectName + '</span></a></td>';
            projectList += '<td><span th:text="' + projectSummary+ '">' + projectSummary + '</span></td>';
            projectList += '</tr>';
          }
          projectList += '</tbody></table>';

          $("#projectTable").html("");
          $("#projectTable").append(projectList);
        },
        error:function(key, textStatus){
        }
      });
    }
  </script>
</head>
<body>
<header th:insert="common/header.html"></header>
<div class="container">
  <div id="projectTable">
  </div>
  <div class="col-md-12">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#projectCreateModal" onclick="fn_projectCreate();">프로젝트 등록</button>
    <button type="button" class="btn btn-primary" onclick="fn_projectList();">프로젝트 조회</button>
  </div>
  <div class="modal fade" id="projectCreateModal" tabindex="-1" role="dialog" aria-labelledby="projectCreateLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="projectCreateLabel">프로젝트 등록</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form>
            <div class="form-group">
              <label for="projectName">프로젝트명</label>
              <input type="text" class="form-control" id="projectName" placeholder="프로젝트명을 입력하세요">
            </div>
            <div class="form-group">
              <label for="projectSummary">프로젝트 Summary</label>
              <input type="text" class="form-control" id="projectSummary" placeholder="프로젝트 요약을 입력하세요">
            </div>
            <div class="form-group">
              <label for="projectStatus">프로젝트 상태</label>
              <select class="form-control" id="projectStatus">
                <option value="TODO" selected>해야 함</option>
                <option value="STOPPED">일시 정지</option>
                <option value="PROGRESS">진행중</option>
                <option value="CANCELED">취소됨</option>
                <option value="RESOLVED">완료됨</option>
              </select>
            </div>
            <div class="form-group">
              <label for="projectPriority">프로젝트 우선순위</label>
              <select class="form-control" id="projectPriority">
                <option value="VERYHIGH" selected>중요도 매우 높음</option>
                <option value="HIGH">중요도 높음</option>
                <option value="NORMAL">보통</option>
                <option value="LOW">중요도 낮음</option>
                <option value="VERYLOW">중요도 매우 낮음</option>
              </select>
            </div>
            <div class="form-group">
              <label for="startDate">프로젝트 시작일시</label>
              <input type='datetime-local' class="form-control" ID='startDate'/>
            </div>
            <div class="form-group">
              <label for="endDate">프로젝트 종료일시</label>
              <input type='datetime-local' class="form-control" ID='endDate'/>
            </div>
            <div class="form-group" id="userCheckList">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button>
          <button type="button" class="btn btn-primary" id="btn-save">등록</button>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="/webjars/jquery/3.5.1/jquery.min.js"></script>
<script src="/webjars/bootstrap/4.5.0/js/bootstrap.min.js"></script>
</body>
</html>